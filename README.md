### kratos-layout 目录说明

#### api目录
api目录主要编写和定义protoc的地方，protoc按照功能进行划分分类形成不同的service分组。
举个列子博客系统，具有用户、文章两个大领域，针对这两个领域进行划分成两个不同的service.
用户领域下具有有用户的增删查改，登录、注销等，文章领域下具有文章的增删查改、点赞、阅读、查看阅读人数、查看阅读人员等。在此示例中，我们在api目录下定义了userpb和noticepb两个目录
。

noticepb 和 userpb下直接定义了protoc,并没有像官网提供的示例那样定义为user/service/v1这样的形式，这是因为如果后续这样定义会形成很多同名的包（user/service/v1、notice/service/v1...）在使用的时候增加了重命名的代码复杂度。

除了userpb和noticepb之外还有一个errors目录，errors是用来定义全局的异常错误的，当然你也可以定义在对应的领域内，不过可能有一些错误是通用错误，每个领域都会进行使用，定义到全局会减少部分代码的编写。

#### cmd目录
cmd 目录是启动目录，里面主要是实现了配置的变更监听和调用service进行服务注册。


#### internal/biz目录
主要负责了领域的业务实现。和kratos不一样的时，在这里将biz，通过进行不同的领域进行包归类，在示例中
我们可以看到具有biz/user/ 和biz/notice/ 一biz/user/为列子，biz/user包下具有以下文件
- biz.go 主要负责具体的领域业务实现
- biz_test.go 主要负责领域业务的单元测试
- entity.go 主要负责定义领域实体
- repo.go 主要负责定义领域的repo接口
- types.go 主要负责定义领域方法的参数。

相对于kratos，不会把biz的全部数据写在一个go文件中，防止单个文件的代码数量太多，难以维护。

当然我们在用户领域中，绝对不可能只用一个用户实体，我们通常在登录接口中使用第三方授权登录，那么可能又会增加一个UserAuth实体，这个实体也是属于用户领域的一部分，可以直接在entity.go文件中进行定义，在biz中实现具体的biz业务。


#### internal/conf
主要负责整个内部系统的配置文件，和kratos不一样的是，我采用的是结构体直接定义，而不是使用protoc定义，这样在很大程度上，会更加方便在开发的过程中进行使用。
另外需要注意的是conf定义在internal内是为了防止第三方服务在引用当前服务时，调用到其配置文件。

#### internal/consts
主要定义了系统全局的常量，在开发的过程中肯定会遇到一些全局的枚举常量的，定义在这里就好了。


#### internal/data
主要负责biz层的repo的具体实现，负责数据增删查改。当然你需要请求一些外部的接口数据也可以放在这里进行实现。

#### internal/pkg
主要负责内部系统的一些方法包封装，这里放到internal下时为了防止外部调用。

#### internal/service
主要负责内部系统的grpc和http服务注册

#### static
主要存放系统的一些静态资源文件

#### third_party
主要存放三方的protoc文件

#### tmp
主要存放临时文件，如日志等


#### 其他说明
在这里我像特地说明一下关于服务根据不同的应用领域进行分类的问题，在kratos的官网示例beer-shop中，根据用户端、管理端将对领域又进行了分类为admin/interface...
admin/interface/..分成了不同的服务进行启动。但是其实无论时管理端还是用户端，在日常的开发中，我们并不会对其进行拆分成多个服务进行运行，因为他们本身就属于同一个领域中，这样太过于细致的划分，会导致服务的数量增加，也增加了维护成本。其次时进行划分会重复定义biz和data，一个数据表的抽象数据结构需要在每个端都定义一遍，也不是一个明智的选择。
在这里其实我更加主张在通过service中进行实现。我们可以通过接口来进行区分不同的请求端，比如管理端可以用过/admin/xxx 客户端可以通过/client/xxx 这样在配置网关的使用可以通过网关进行较好的接口鉴权。
